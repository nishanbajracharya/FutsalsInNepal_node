<% include layout %>
<div id="map">
	
</div>
<script>
	var map;

	var mp = (<%- JSON.stringify(results) %>);
	console.log(mp);
	var markerC = [];
	for(i in mp){
		if(mp[i].map != undefined) markerC.push(mp[i]);
	}
	function initMap() {

		map = new google.maps.Map(document.getElementById('map'), {
			center: {lat: 0, lng: 0},
			zoom: 14
		});


        // Try HTML5 geolocation.
        if (navigator.geolocation) {
        	navigator.geolocation.getCurrentPosition(function(position) {
        		var pos = {
        			lat: position.coords.latitude,
        			lng: position.coords.longitude
        		};

        		map.setCenter(pos);
        		var marker = new google.maps.Marker({
        			position: pos,
        			map: map,
        			title: 'You are here',
        			icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png'
        		});
        	}, function() {
        		handleLocationError(true, null, map.getCenter());
        	});
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, null, map.getCenter());
      }
      for(i in markerC){
      	var coor = markerC[i].map.split(',');
      	var pos = {
      		lat: parseFloat(coor[0]),
      		lng: parseFloat(coor[1])
      	};
      	var marker = new google.maps.Marker({
      		position: pos,
      		map: map,
      		title: markerC[i].name,
      		icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png'
      	});
      }
  }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC9WM8cPSOvqBUNoy_QTYo0ds8u7ReY2Ms&callback=initMap"
async defer></script>
<div id="listings">
	<div class="container">
		<div class="row">
			<%for (var i in results){%>
			<div class="futsal col-md-3 col-xs-12 col-sm-4">
				<div class="elem">
					<p class="title"><%=results[i].name%></p>   
					<p class="location">Address : <%=results[i].address%></p>  
					<p class="Phone">Phone :<%=results[i].phone%></p> 
					<p class="openhours">Rate : Rs <%=results[i].rate%> / hour</p>
					<p class="openhours">Open Hours : <%=results[i].openhours%></p>
					<a href="/futsals/<%-results[i].name%>">more</a>
				</div>
			</div>
			<%}%>
		</div>
	</div>
</div>